{% extends "management/admin/base.html" %}

{% block admin_stylesheets %}
    {% include "management/includes/_edges_common_css.html" %}
    {# FIXME: for some reason this is not in edges common, why is that? #}
    <link rel="stylesheet" type="text/css" href="/static/doaj/css/edges.css">
{% endblock %}

{% block page_title %}Journals{% endblock %}

{% block admin_content %}
    <h1 class="sr-only">Journals</h1>

    <div class="row">
        <div class="col-md-12">
            <button type="button" class="btn btn-primary" id="export_as_csv">Export as CSV</button>
        </div>
    </div>
    <div id="admin_journals"></div>
{% endblock %}

{% block admin_js %}
    <script type="text/javascript">
        $.extend(true, doaj, {
            adminJournalsSearchConfig : {
                journalEditUrl : "{{ url_for('admin.journal_page', journal_id='') }}",
                applicationsUrl : "{{ url_for('admin.suggestions') }}",
                searchPath : '/admin_query/journal/_search'
            }
        });
    </script>

    {% include "includes/_edges_common_js.html" %}
    <script type="text/javascript" src="/static/js/edges/admin.journals.edge.js?v={{config.get('DOAJ_VERSION')}}"></script>

    <script type="text/javascript">
        $(document).ready(function() {
            $("#export_as_csv").on("click", function() {
                let cq = doaj.adminJournalsSearch.activeEdges["#admin_journals"].currentQuery;
                $.post("/");
            })

        });
    </script>
{% endblock %}
