<!--[if IE]>
<p class="browserupgrade">You are using an outdated browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
<![endif]-->
<div class="primary-nav" id="primary-nav">
    <div class="container">
        <div class="row flex-center primary-nav__content">
            <div class="col-xs-4">
                <a href="/" class="logo">
                    <h2 class="sr-only">The Directory of Open Access Journals</h2>
                    {% include "includes/svg/logo.svg" %}
                    <span class="logo__tagline">
                      Open <br/>Global <br/>Trusted
                    </span>
                </a>
            </div>
            <nav class="col-xs-8 flex-end">
                <h2 class="sr-only">Main actions</h2>
                {% set columns = data.nav.entries|selectattr("primary")|list %}
                  <ul class="nav-bar" role="menubar" id="main_actions">
                    {% for column in columns %}
                        {% set section_id=column.id %}
                        {% include "includes/header-primary-navigation.html" %}
                    {% endfor %}
                    <li class="flex-center primary-nav__search" data-toggle="modal" data-target="#modal-search" tabindex="0" role="button">
                      <span class="label"> Search</span>
                      <span data-feather="search" aria-hidden="true"></span>
                    </li>
                </ul>
                <div class="secondary-nav__menu-toggle" aria-label="Click to open menu" role="button">
                    <span class="label">Menu</span> <span data-feather="menu" aria-hidden="true"></span>
                </div>
            </nav>
        </div>
    </div>
</div>

{# static pages may declare "highlight" in their front matter, and if they do we want to adjust the nav accordingly #}
{% set extraClass = "" %}
{% if page %}
    {% if page.highlight %}
        {% set extraClass="secondary-nav--precedes-highlight" %}
    {% endif %}
{% endif %}
<nav class="secondary-nav {{ extraClass }}">
    <div class="container">
        <h2 class="sr-only">Secondary actions</h2>
        <ul class="nav-bar secondary-nav__menu" role="menubar">

            {% set columns = data.nav.entries|selectattr("secondary")|list %}
            {% for column in columns %}
                {% set section_id=column.id %}
                {% include "includes/header-secondary-navigation.html" %}
            {% endfor %}

            {% if not current_user.is_anonymous %}
                <li class="dropdown" role="none">
                        <a href="" class="dropdown__trigger nav-bar__link" id="menu-account" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" role="menuitem">
                            My Account
                            <span data-feather="chevron-down" aria-hidden="true"></span>
                        </a>
                    <ul class="dropdown__menu" aria-labelledby="menu-account" role="menu">
                        {% if current_user.has_role("admin") %}
                            <li role="none">
                                <a href="{{ url_for('admin.index') }}" class="dropdown__link" role="menuitem">
                                    Admin
                                </a>
                            </li>
                        {% endif %}
                        {% if current_user.has_role("editor") or current_user.has_role("associate_editor") %}
                            <li role="none">
                                <a href="{{ url_for('editor.index') }}" class="dropdown__link" role="menuitem">
                                    Editor
                                </a>
                            </li>
                        {% endif %}
                        {% if current_user.has_role("publisher") %}
                            <li role="none">
                                <a href="{{ url_for('publisher.index') }}" class="dropdown__link" role="menuitem">
                                    Publisher
                                </a>
                            </li>
                        {% endif %}
                        <li role="none">
                            <a href="{{ url_for('account.username', username=current_user.id) }}" class="dropdown__link" role="menuitem">
                                Settings
                            </a>
                        </li>
                    </ul>
                </li>
            {% endif %}

            {% set columns = data.nav.entries|selectattr("secondary_mobile")|list %}
            {% for column in columns %}
                {% set section_id=column.id %}
                {% set mobile=True %}
                {% include "includes/header-secondary-navigation.html" %}
            {% endfor %}

            <li class="secondary-nav__login" role="none">
                {% if current_user.is_anonymous %}
                    <a href="{{ url_for('account.login') }}" class="nav-bar__link" role="menuitem">
                        Login
                        <span data-feather="log-in" aria-hidden="true"></span>
                    </a>
                {% else %}
                    <a href="{{ url_for('account.logout') }}" class="nav-bar__link" role="menuitem">
                        Logout
                        <span data-feather="log-out" aria-hidden="true"></span>
                    </a>
                {% endif %}
            </li>
        </ul>
    </div>
</nav>
