{% extends "layouts/public_base.html" %}

{% block body_class %}
    journal-details
{% endblock %}

{% block page_title %}{% include "doaj/includes/_journal_meta_title.html" %}{% endblock %}
{% block meta_og_title %}{% include "doaj/includes/_journal_meta_title.html" %}{% endblock %}
{% block meta_twitter_title %}{% include "doaj/includes/_journal_meta_title.html" %}{% endblock %}
{%- block meta_description -%}{% include "doaj/includes/_journal_meta_description.html" %}{%- endblock -%}
{%- block meta_og_description -%}{% include "doaj/includes/_journal_meta_description.html" %}{%- endblock -%}
{%- block meta_twitter_description -%}{% include "doaj/includes/_journal_meta_description.html" %}{%- endblock -%}

{% block content %}


    <main class="container page-content">
        <header>
          {% if journal.last_manually_updated_since(days=30) %}
          <span class="label label--secondary">
              <span data-feather="clock" aria-hidden="true"></span>
              <span title="Updated {{journal.last_manual_update_timestamp.strftime("%e %B %Y")}}">Updated recently</span>
          </span>
          {% endif %}
          <h1 class="row">
            <span class="col-xs-9 col-md-8">
              {{ bibjson.title }}
              {% if bibjson.alternative_title %}
              <span aria-hidden="true" class="journal-details__alt-title">{{ bibjson.alternative_title }}</span>
              {% endif %}
            </span>
            {%- set seal = journal.has_seal() -%}
            {%- if seal -%}
            <div class="col-xs-3 col-md-4 flex-end">
              <a href="/apply/seal/">
                {% include "includes/svg/seal.svg" %}
                <p class="sr-only">This journal has been awarded the DOAJ Seal.</p>
              </a>
            </div>
            {%- endif %}
          </h1>
            <p>
                <span class="label">
                    <span data-feather="book-open" aria-hidden="true"></span>
                    {# this next bit has to be all on one line so that the spacing is correct #}
                    {% if bibjson.pissn %}{{bibjson.pissn}} (Print){% endif %}{% if bibjson.eissn %}{% if bibjson.pissn %}&nbsp;/ {% endif %}{{bibjson.eissn}} (Online){% endif %}
                </span>
            </p>

            {% if bibjson.discontinued_date %}
                <p>Ceased publication on <strong>{{ bibjson.discontinued_datestamp.strftime("%d %B %Y") }}</strong></p>
            {% endif %}

            {% set past = journal.get_past_continuations() %}
            {% if past %}
                <p>Continues
                    {% for p in past %}
                        {% set bibjson = p.bibjson() %}
                        {% if bibjson.issns()|length > 0 %}
                            {% if p.is_in_doaj() %}
                                <em><a href="{{ url_for('doaj.toc', identifier=bibjson.get_preferred_issn()) }}">{{ bibjson.title }}</a></em>
                            {% else %}
                                <em>{{ bibjson.title }}</em>, ISSN: {{ bibjson.get_preferred_issn() }} (not available in DOAJ)
                            {% endif %}
                        {% endif %}
                        {% if not loop.last %}; {% endif %}
                    {% endfor %}
                </p>
            {% endif %}

            {% set future = journal.get_future_continuations() %}
            {% if future %}
                <p>Continued by
                    {% for f in future %}
                        {% set bibjson = f.bibjson() %}
                        {% if bibjson.issns()|length > 0 %}
                            {% if f.is_in_doaj() %}
                                <em><a href="{{ url_for('doaj.toc', identifier=bibjson.get_preferred_issn()) }}">{{ bibjson.title }}</a></em>
                            {% else %}
                                <em>{{ bibjson.title }}</em>, ISSN: {{ bibjson.get_preferred_issn() }} (not available in DOAJ)
                            {% endif %}
                        {% endif %}
                        {% if not loop.last %}; {% endif %}
                    {% endfor %}
                </p>
            {% endif %}

            <ul class="tags">
                {% if bibjson.journal_url %}
                <li class="tag">
                    <a href="{{ bibjson.journal_url }}" target="_blank" rel="noopener">
                        <span data-feather="external-link" aria-hidden="true"></span>
                        Website
                    </a>
                </li>
                {% endif %}

                <li class="tag">
                  <a href="https://portal.issn.org/resource/ISSN/{{ bibjson.get_preferred_issn() }}"
                     target="_blank" rel="noopener">
                      <span data-feather="external-link" aria-hidden="true"></span>
                      ISSN Portal
                  </a>
              </li>
            </ul>
        </header>

        <div class="tabs">
            <nav class="tabs__menu">
                <ul class="tabs__list">
                    <li class="tabs__item">
                        {% set _url =url_for('doaj.toc', identifier=journal.toc_id)  %}
                        <a href="{{ _url }}"
                           aria-selected="{{ 'true' if  _url in request.url else 'false' }}" >
                            About
                        </a>
                    </li>
                    <li class="tabs__item">
                        {% set _url =url_for('doaj.toc_articles', identifier=journal.toc_id)  %}
                        <a href="{{ _url }}"
                           aria-selected="{{ 'true' if _url in request.url else 'false' }}" >
                            Articles
                        </a>
                    </li>
                </ul>
            </nav>

            <div class="tabs__content">
                {% block toc_content %} {% endblock %}
            </div>
        </div>

        <footer id="updated" class="page-content__footer">
            <p>
                Added {{journal.created_timestamp.strftime("%e %B %Y")}}
                {% if journal.last_manual_update_timestamp and
                      dates.format(journal.last_manual_update_timestamp) != dates.DEFAULT_TIMESTAMP_VAL
                 %}
                    &bull; Updated {{journal.last_manual_update_timestamp.strftime("%e %B %Y")}}
                {% endif %}
            </p>
        </footer>

    </main>
    {% include "includes/_hotjar.html" %}

{% endblock %}
