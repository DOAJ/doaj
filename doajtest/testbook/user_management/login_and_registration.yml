suite: User Management
testset: Login and Registration
tests:
- title: Ensure Case Insensitive login
  context:
    role: anonymous
  steps:
  - step: Ensure a user exists with email "test@test.com" and password "password123"
  - step: Go to login page at /account/login
  - step: Provide email "test@test.com" and password "password123"
    results:
    - user correctly logged in
  - step: Log out
  - step: Go to login page at /account/login
  - step: Provide email "TEST@test.com" and password "password123"
    results:
    - user correctly logged in
- title: Ensure Case Sensitive Registration
  context:
    role: anonymous
  steps:
    - step: Ensure a user exists with email "test@test.com" and password "password123"
    - step: Ensure a user with email "TestUser@test.com" does NOT exist
    - step: Ensure you're logged out
    - step: Go to registration page at /account/register
    - step: Provide "Test User" as a Name and "test@test.com", check captcha and click "Register" button
      results:
      - The "That email is already in use" error is displayed
    - step: Provide "Test User" as a Name and "TEST@test.com", check captcha and click "Register" button
      results:
      - The "That email is already in use" error is displayed
    - step: Provide "Test User" as a Name and "TestUser@test.com", check captch and click "Register" button
      results:
      - The User is registered and redirected to the homepage
      - A prompt to verify email address is displayed at the top
    - step: Verify the email, set password "password123" and user name to "TestUser"
    - step: Log in with the new account
    - step: Go to your account setting at /account/testuser
      results:
      - Email address is displayed as "TestUser@test.com" (confirm correct casing).
- title: Basic Passwordless Login Flow
  context:
    role: anonymous
  steps:
    - step: Ensure a user exists with email "passwordless@test.com" and password "password123"
    - step: Go to login page at /account/login
    - step: Enter email "passwordless@test.com" and click "Get Login Link" button
      results:
      - A message is displayed indicating a login link has been sent
      - The verification code input form is displayed
    - step: Check the email sent to "passwordless@test.com" and note the 6-digit verification code
    - step: Enter the verification code in the form and submit
      results:
      - User is successfully logged in
      - User is redirected to the homepage
- title: Passwordless Login with Incorrect Code
  context:
    role: anonymous
  steps:
    - step: Ensure a user exists with email "passwordless@test.com" and password "password123"
    - step: Go to login page at /account/login
    - step: Enter email "passwordless@test.com" and click "Get Login Link" button
      results:
      - A message is displayed indicating a login link has been sent
      - The verification code input form is displayed
    - step: Enter an incorrect verification code (e.g., "999999") and submit
      results:
      - An error message "Invalid or expired verification code" is displayed
      - User remains on the login page
- title: Login Using Email Link
  context:
    role: anonymous
  steps:
    - step: Ensure a user exists with email "link@test.com" and password "password123"
    - step: Go to login page at /account/login
    - step: Enter email "link@test.com" and click "Get Login Link" button
      results:
      - A message is displayed indicating a login link has been sent
    - step: Check the email sent to "link@test.com" and locate the login link
    - step: Click on the login link in the email
      results:
      - User is automatically logged in without needing to enter the verification code
